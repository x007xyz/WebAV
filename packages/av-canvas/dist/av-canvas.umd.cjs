(function(w,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("@webav/av-cliper"),require("@webav/internal-utils")):typeof define=="function"&&define.amd?define(["exports","@webav/av-cliper","@webav/internal-utils"],f):(w=typeof globalThis<"u"?globalThis:w||self,f(w["av-canvas"]={},w.avCliper,w.internalUtils))})(this,function(w,f,x){"use strict";var Nt=Object.defineProperty;var gt=w=>{throw TypeError(w)};var Vt=(w,f,x)=>f in w?Nt(w,f,{enumerable:!0,configurable:!0,writable:!0,value:x}):w[f]=x;var it=(w,f,x)=>Vt(w,typeof f!="symbol"?f+"":f,x),ut=(w,f,x)=>f.has(w)||gt("Cannot "+x);var e=(w,f,x)=>(ut(w,f,"read from private field"),x?x.call(w):f.get(w)),g=(w,f,x)=>f.has(w)?gt("Cannot add the same private member more than once"):f instanceof WeakSet?f.add(w):f.set(w,x),y=(w,f,x,nt)=>(ut(w,f,"write to private field"),nt?nt.call(w,x):f.set(w,x),x),F=(w,f,x)=>(ut(w,f,"access private method"),x);var O,N,V,U,C,M,I,Q,Z,K,B,tt,z,A,P,j,W,ct,ht,T,Y,D,yt,H,et;const nt=["t","b","l","r","lt","lb","rt","rb","rotate"];function G(n){return document.createElement(n)}function xt(n){let t=16;const r=new ResizeObserver(s=>{const o=s[0];o!=null&&(t=10/(o.contentRect.width/n.width))});r.observe(n);function i(s){const{w:o,h}=s,a=t,c=a/2,l=o/2,d=h/2,p=a*1.5,u=p/2;return{...s.fixedAspectRatio?{}:{t:new f.Rect(-c,-d-c,a,a,s),b:new f.Rect(-c,d-c,a,a,s),l:new f.Rect(-l-c,-c,a,a,s),r:new f.Rect(l-c,-c,a,a,s)},lt:new f.Rect(-l-c,-d-c,a,a,s),lb:new f.Rect(-l-c,d-c,a,a,s),rt:new f.Rect(l-c,-d-c,a,a,s),rb:new f.Rect(l-c,d-c,a,a,s),rotate:new f.Rect(-u,-d-a*2-u,p,p,s)}}return{rectCtrlsGetter:i,destroy:()=>{r.disconnect()}}}var J=(n=>(n.ActiveSpriteChange="activeSpriteChange",n.AddSprite="addSprite",n))(J||{});class St{constructor(){g(this,O,[]);g(this,N,null);g(this,V,new x.EventTool);it(this,"on",e(this,V).on);g(this,U,0)}get activeSprite(){return e(this,N)}set activeSprite(t){t!==e(this,N)&&(y(this,N,t),e(this,V).emit("activeSpriteChange",t))}async addSprite(t){await t.ready,e(this,O).push(t),y(this,O,e(this,O).sort((r,i)=>r.zIndex-i.zIndex)),t.on("propsChange",r=>{r.zIndex!=null&&y(this,O,e(this,O).sort((i,s)=>i.zIndex-s.zIndex))}),e(this,V).emit("addSprite",t)}removeSprite(t){e(this,N)===t&&(this.activeSprite=null),y(this,O,e(this,O).filter(r=>r!==t)),t.destroy()}getSprites(t={time:!0}){return e(this,O).filter(r=>r.visible&&(t.time?e(this,U)>=r.time.offset&&e(this,U)<=r.time.offset+r.time.duration:!0))}updateRenderTime(t){y(this,U,t);const r=this.activeSprite;r!=null&&(t<r.time.offset||t>r.time.offset+r.time.duration)&&(this.activeSprite=null)}destroy(){e(this,V).destroy(),e(this,O).forEach(t=>t.destroy()),y(this,O,[])}}O=new WeakMap,N=new WeakMap,V=new WeakMap,U=new WeakMap;function vt(n,t,r,i){const s={w:t.clientWidth/t.width,h:t.clientHeight/t.height},o=new ResizeObserver(()=>{s.w=t.clientWidth/t.width,s.h=t.clientHeight/t.height,r.activeSprite!=null&&dt(r.activeSprite,a,c,s,i)});o.observe(t);let h=()=>{};const{rectEl:a,ctrlsEl:c}=Mt(n),l=r.on(J.ActiveSpriteChange,d=>{if(h(),d==null){a.style.display="none";return}dt(d,a,c,s,i),h=d.on("propsChange",()=>{dt(d,a,c,s,i)}),a.style.display=""});return()=>{o.disconnect(),l(),a.remove(),h()}}function Mt(n){const t=G("div");t.style.cssText=`
    position: absolute;
    pointer-events: none;
    border: 1px solid #eee;
    box-sizing: border-box;
    display: none;
  `;const r=Object.fromEntries(nt.map(i=>{const s=G("div");return s.style.cssText=`
        display: none;
        position: absolute;
        border: 1px solid #3ee; border-radius: 50%;
        box-sizing: border-box;
        background-color: #fff;
      `,[i,s]}));return Object.values(r).forEach(i=>t.appendChild(i)),n.appendChild(t),{rectEl:t,ctrlsEl:r}}function dt(n,t,r,i,s){const{x:o,y:h,w:a,h:c,angle:l}=n.rect;Object.assign(t.style,{left:`${o*i.w}px`,top:`${h*i.h}px`,width:`${a*i.w}px`,height:`${c*i.h}px`,rotate:`${l}rad`}),Object.entries(s(n.rect)).forEach(([d,{x:p,y:u,w:m,h:S}])=>{Object.assign(r[d].style,{display:"block",left:"50%",top:"50%",width:`${m*i.w}px`,height:`${S*i.h}px`,transform:`translate(${p*i.w}px, ${u*i.h}px)`})})}function Ct(n,t,r){const i={w:n.clientWidth/n.width,h:n.clientHeight/n.height},s=new ResizeObserver(()=>{i.w=n.clientWidth/n.width,i.h=n.clientHeight/n.height});s.observe(n);const o=h=>{if(h.button!==0)return;const{offsetX:a,offsetY:c}=h,l=a/i.w,d=c/i.h;if(t.activeSprite!=null){const[p]=Object.entries(r(t.activeSprite.rect)).find(([,u])=>u.checkHit(l,d))??[];if(p!=null)return}t.activeSprite=t.getSprites().reverse().find(p=>p.visible&&p.rect.checkHit(l,d))??null};return n.addEventListener("pointerdown",o),()=>{s.disconnect(),n.removeEventListener("pointerdown",o)}}function Tt(n,t,r,i){const s={w:n.clientWidth/n.width,h:n.clientHeight/n.height},o=new ResizeObserver(()=>{s.w=n.clientWidth/n.width,s.h=n.clientHeight/n.height});o.observe(n);let h=0,a=0,c=null;const l=zt(n,r);let d=null;const p=S=>{if(S.button!==0||t.activeSprite==null)return;d=t.activeSprite;const{offsetX:k,offsetY:R,clientX:v,clientY:b}=S;At({rect:d.rect,offsetX:k,offsetY:R,clientX:v,clientY:b,cvsRatio:s,cvsEl:n,rectCtrlsGetter:i})||(c=d.rect.clone(),l.magneticEffect(d.rect.x,d.rect.y,d.rect),h=v,a=b,window.addEventListener("pointermove",u),window.addEventListener("pointerup",m))},u=S=>{if(d==null||c==null)return;const{clientX:k,clientY:R}=S;let v=c.x+(k-h)/s.w,b=c.y+(R-a)/s.h;pt(d.rect,n,l.magneticEffect(v,b,d.rect))};n.addEventListener("pointerdown",p);const m=()=>{l.hide(),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",m)};return()=>{o.disconnect(),l.destroy(),m(),n.removeEventListener("pointerdown",p)}}function kt({sprRect:n,startX:t,startY:r,ctrlKey:i,cvsRatio:s,cvsEl:o}){const h=n.clone(),a=l=>{const{clientX:d,clientY:p}=l,u=(d-t)/s.w,m=(p-r)/s.h,S=i.length===1?It:Rt,{x:k,y:R,w:v,h:b}=h,E=Math.atan2(b,v),{incW:rt,incH:st,incS:q,rotateAngle:wt}=S({deltaX:u,deltaY:m,angle:n.angle,ctrlKey:i,diagonalAngle:E}),L=10;let $=v,_=b,ot=h.fixedScaleCenter?rt*2:rt,at=h.fixedScaleCenter?st*2:st,X=q;const mt=Math.sqrt(b**2+v**2),bt=Math.sqrt((L*(b/v))**2+L**2);switch(i){case"l":$=Math.max(v+ot,L),X=Math.min(q,v-L);break;case"r":$=Math.max(v+ot,L),X=Math.max(q,L-v);break;case"b":_=Math.max(b+at,L),X=Math.min(q,b-L);break;case"t":_=Math.max(b+at,L),X=Math.max(q,L-b);break;case"lt":case"lb":$=Math.max(v+ot,L),_=$===L?b/v*$:b+at,X=Math.min(q,mt-bt);break;case"rt":case"rb":$=Math.max(v+ot,L),_=$===L?b/v*$:b+at,X=Math.max(q,bt-mt);break}let lt=k,ft=R;if(h.fixedScaleCenter)lt=k+v/2-$/2,ft=R+b/2-_/2;else{const Xt=X/2*Math.cos(wt)+k+v/2,Ft=X/2*Math.sin(wt)+R+b/2;lt=Xt-$/2,ft=Ft-_/2}pt(n,o,{x:lt,y:ft,w:$,h:_})},c=()=>{window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",c)};window.addEventListener("pointermove",a),window.addEventListener("pointerup",c)}function It({deltaX:n,deltaY:t,angle:r,ctrlKey:i}){let s=0,o=0,h=0,a=r;return i==="l"||i==="r"?(s=n*Math.cos(r)+t*Math.sin(r),o=s*(i==="l"?-1:1)):(i==="t"||i==="b")&&(a=r-Math.PI/2,s=n*Math.cos(a)+t*Math.sin(a),h=s*(i==="b"?-1:1)),{incW:o,incH:h,incS:s,rotateAngle:a}}function Rt({deltaX:n,deltaY:t,angle:r,ctrlKey:i,diagonalAngle:s}){const o=(i==="lt"||i==="rb"?1:-1)*s+r,h=n*Math.cos(o)+t*Math.sin(o),a=i==="lt"||i==="lb"?-1:1,c=h*Math.cos(s)*a,l=h*Math.sin(s)*a;return{incW:c,incH:l,incS:h,rotateAngle:o}}function At({rect:n,cvsRatio:t,offsetX:r,offsetY:i,clientX:s,clientY:o,cvsEl:h,rectCtrlsGetter:a}){const c=r/t.w,l=i/t.h,[d]=Object.entries(a(n)).find(([,p])=>p.checkHit(c,l))??[];return d==null?!1:(d==="rotate"?Lt(n,Ot(n.center,t,h)):kt({sprRect:n,ctrlKey:d,startX:s,startY:o,cvsRatio:t,cvsEl:h}),!0)}function Lt(n,t){const r=({clientX:s,clientY:o})=>{const h=s-t.x,a=o-t.y,c=Math.atan2(a,h)+Math.PI/2;n.angle=c},i=()=>{window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",i)};window.addEventListener("pointermove",r),window.addEventListener("pointerup",i)}function Ot(n,t,r){const i=n.x*t.w,s=n.y*t.h,{left:o,top:h}=r.getBoundingClientRect();return{x:i+o,y:s+h}}function pt(n,t,r){const i={x:n.x,y:n.y,w:n.w,h:n.h,...r},s=t.width*.05,o=t.height*.05;i.x<-i.w+s?i.x=-i.w+s:i.x>t.width-s&&(i.x=t.width-s),i.y<-i.h+o?i.y=-i.h+o:i.y>t.height-o&&(i.y=t.height-o),n.x=i.x,n.y=i.y,n.w=i.w,n.h=i.h}function zt(n,t){const r="display: none; position: absolute;",i={w:0,h:0,x:0,y:0},s={vertMiddle:{...i,h:100,x:50,ref:{prop:"x",val:({w:c})=>(n.width-c)/2}},horMiddle:{...i,w:100,y:50,ref:{prop:"y",val:({h:c})=>(n.height-c)/2}},top:{...i,w:100,ref:{prop:"y",val:()=>0}},bottom:{...i,w:100,y:100,ref:{prop:"y",val:({h:c})=>n.height-c}},left:{...i,h:100,ref:{prop:"x",val:()=>0}},right:{...i,h:100,x:100,ref:{prop:"x",val:({w:c})=>n.width-c}}},o=G("div");o.style.cssText=`
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    box-sizing: border-box;
  `;const h=Object.fromEntries(Object.entries(s).map(([c,{w:l,h:d,x:p,y:u}])=>{const m=G("div");return m.style.cssText=`
        ${r}
        border-${l>0?"top":"left"}: 1px solid #3ee;
        top: ${u}%; left: ${p}%;
        ${p===100?"margin-left: -1px":""};
        ${u===100?"margin-top: -1px":""};
        width: ${l}%; height: ${d}%;
      `,o.appendChild(m),[c,m]}));t.appendChild(o);const a=6/(900/n.width);return{magneticEffect(c,l,d){const p={x:c,y:l};let u,m={x:!1,y:!1};for(u in s){const{prop:S,val:k}=s[u].ref;if(m[S])continue;const R=k(d);Math.abs(d[S]-R)<=a&&Math.abs(d[S]-(S==="x"?c:l))<=a?(p[S]=R,h[u].style.display="block",m[S]=!0):h[u].style.display="none"}return p},hide(){Object.values(h).forEach(c=>c.style.display="none")},destroy(){o.remove()}}}function Wt(n,t,r){const i={w:n.clientWidth/n.width,h:n.clientHeight/n.height},s=new ResizeObserver(()=>{i.w=n.clientWidth/n.width,i.h=n.clientHeight/n.height});s.observe(n);const o=n.style;let h=t.activeSprite;t.on(J.ActiveSpriteChange,m=>{h=m,m==null&&(o.cursor="")});let a=!1;const c=({offsetX:m,offsetY:S})=>{a=!0;const k=m/i.w,R=S/i.h;(h==null?void 0:h.rect.checkHit(k,R))===!0&&o.cursor===""&&(o.cursor="move")},l=()=>{a=!1},d=["ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize"],p={t:0,rt:1,r:2,rb:3,b:4,lb:5,l:6,lt:7},u=m=>{if(h==null||a)return;const{offsetX:S,offsetY:k}=m,R=S/i.w,v=k/i.h,[b]=Object.entries(r(h.rect)).find(([,E])=>E.checkHit(R,v))??[];if(b!=null){if(b==="rotate"){o.cursor="crosshair";return}const E=h.rect.angle,rt=E<0?E+2*Math.PI:E,st=(p[b]+Math.floor((rt+Math.PI/8)/(Math.PI/4)))%8;o.cursor=d[st];return}if(h.rect.checkHit(R,v)){o.cursor="move";return}o.cursor=""};return n.addEventListener("pointermove",u),n.addEventListener("pointerdown",c),window.addEventListener("pointerup",l),()=>{s.disconnect(),n.removeEventListener("pointermove",u),n.removeEventListener("pointerdown",c),window.removeEventListener("pointerup",l)}}const Ht={sampleRate:48e3,channelCount:2,codec:"mp4a.40.2"};function $t(n){const t=G("canvas");return t.style.cssText=`
    width: 100%;
    height: 100%;
    display: block;
    touch-action: none;
  `,t.width=n.width,t.height=n.height,t}class Pt{constructor(t,r){g(this,W);g(this,C);g(this,M);g(this,I);g(this,Q,!1);g(this,Z,[]);g(this,K);g(this,B,new x.EventTool);it(this,"on",e(this,B).on);g(this,tt);g(this,z,{mode:"cover",opacity:1,blur:0});g(this,A,null);g(this,P,null);g(this,j,0);g(this,T,new AudioContext);g(this,Y,e(this,T).createMediaStreamDestination());g(this,D,new Set);g(this,H,{start:0,end:0,step:0,audioPlayAt:0});g(this,et,new WeakMap);it(this,"addSprite",async t=>{e(this,T).state==="suspended"&&e(this,T).resume().catch(f.Log.error);const r=t.getClip();if(r instanceof f.MediaStreamClip&&r.audioTrack!=null){const i=e(this,T).createMediaStreamSource(new MediaStream([r.audioTrack]));i.connect(e(this,Y)),e(this,et).set(t,i)}await e(this,M).addSprite(t),t.preFrame(0)});it(this,"removeSprite",t=>{var r;(r=e(this,et).get(t))==null||r.disconnect(),e(this,M).removeSprite(t)});y(this,tt,r),y(this,C,$t(r));const i=e(this,C).getContext("2d",{alpha:!1});if(i==null)throw Error("canvas context is null");y(this,I,i);const s=G("div");s.style.cssText="width: 100%; height: 100%; position: relative; overflow: hidden;",s.appendChild(e(this,C)),t.appendChild(s),jt(e(this,T)).connect(e(this,Y)),y(this,M,new St);const{rectCtrlsGetter:o,destroy:h}=xt(e(this,C));e(this,Z).push(h,Ct(e(this,C),e(this,M),o),Wt(e(this,C),e(this,M),o),Tt(e(this,C),e(this,M),s,o),vt(s,e(this,C),e(this,M),o),e(this,M).on(J.AddSprite,p=>{const{rect:u}=p;u.x===0&&u.y===0&&(u.x=(e(this,C).width-u.w)/2,u.y=(e(this,C).height-u.h)/2)}),x.EventTool.forwardEvent(e(this,M),e(this,B),[J.ActiveSpriteChange]));let a=e(this,j),c=performance.now(),l=0;const d=1e3/30;y(this,K,x.workerTimer(()=>{if(!((performance.now()-c)/(d*l)<1)){if(l+=1,e(this,I).fillStyle=r.bgColor,e(this,I).fillRect(0,0,e(this,C).width,e(this,C).height),e(this,A)){const{width:p,height:u}=e(this,C),{mode:m,opacity:S}=e(this,z);switch(e(this,I).save(),S!==1&&(e(this,I).globalAlpha=S),m){case"cover":Yt(e(this,I),e(this,A),0,0,p,u);break;case"contain":Dt(e(this,I),e(this,A),0,0,p,u);break;case"stretch":e(this,I).drawImage(e(this,A),0,0,p,u);break;case"repeat":const k=e(this,I).createPattern(e(this,A),"repeat");k&&(e(this,I).fillStyle=k,e(this,I).fillRect(0,0,p,u));break}}F(this,W,yt).call(this),a!==e(this,j)&&(a=e(this,j),e(this,B).emit("timeupdate",Math.round(a)))}},d))}play(t){const r=e(this,M).getSprites({time:!1}).map(s=>s.time.offset+s.time.duration),i=t.end??(r.length>0?Math.max(...r):1/0);if(t.start>=i||t.start<0)throw Error(`Invalid time parameter, ${JSON.stringify({start:t.start,end:i})}`);F(this,W,ct).call(this,t.start),e(this,M).getSprites({time:!1}).forEach(s=>{const{offset:o,duration:h}=s.time,a=e(this,j)-o;s.preFrame(a>0&&a<h?a:0)}),e(this,H).start=t.start,e(this,H).end=i,e(this,H).step=(t.playbackRate??1)*(1e3/30)*1e3,e(this,T).resume(),e(this,H).audioPlayAt=0,e(this,B).emit("playing"),f.Log.info("AVCanvs play by:",e(this,H))}pause(){F(this,W,ht).call(this)}previewFrame(t){F(this,W,ct).call(this,t),F(this,W,ht).call(this)}captureImage(){return e(this,C).toDataURL()}get activeSprite(){return e(this,M).activeSprite}set activeSprite(t){e(this,M).activeSprite=t}destroy(){var t;e(this,Q)||(y(this,Q,!0),e(this,T).close(),e(this,Y).disconnect(),e(this,B).destroy(),e(this,K).call(this),(t=e(this,C).parentElement)==null||t.remove(),e(this,Z).forEach(r=>r()),e(this,D).clear(),e(this,M).destroy())}captureStream(){e(this,T).state==="suspended"&&e(this,T).resume().catch(f.Log.error);const t=new MediaStream(e(this,C).captureStream().getTracks().concat(e(this,Y).stream.getTracks()));return f.Log.info("AVCanvas.captureStream, tracks:",t.getTracks().map(r=>r.kind)),t}async createCombinator(t={}){f.Log.info("AVCanvas.createCombinator, opts:",t);const r=new f.Combinator({...e(this,tt),...t}),i=e(this,M).getSprites({time:!1});if(i.length===0)throw Error("No sprite added");for(const s of i){const o=new f.OffscreenSprite(s.getClip());o.time={...s.time},s.copyStateTo(o),await r.addSprite(o)}return r}async setBackgroundImage(t,r={}){let i;if(typeof t=="string"){const o=await(await fetch(t)).blob();i=await createImageBitmap(o)}else t instanceof HTMLImageElement?i=await createImageBitmap(t):i=t;if(y(this,P,i),y(this,z,{mode:r.mode||"cover",opacity:r.opacity!==void 0?r.opacity:1,blur:r.blur!==void 0?r.blur:0}),e(this,z).blur>0){const s=new OffscreenCanvas(i.width,i.height),o=s.getContext("2d");o?(o.filter=`blur(${e(this,z).blur}px)`,o.drawImage(i,0,0),y(this,A,await createImageBitmap(s))):y(this,A,i)}else y(this,A,i)}async updateBackgroundOptions(t={}){if(e(this,P)&&(t.mode!==void 0&&(e(this,z).mode=t.mode),t.opacity!==void 0&&(e(this,z).opacity=t.opacity),t.blur!==void 0&&(e(this,z).blur=t.blur),t.blur!==void 0))if(e(this,z).blur>0){const r=new OffscreenCanvas(e(this,P).width,e(this,P).height),i=r.getContext("2d");i&&(i.filter=`blur(${e(this,z).blur}px)`,i.drawImage(e(this,P),0,0),y(this,A,await createImageBitmap(r)))}else y(this,A,e(this,P))}clearBackgroundImage(){y(this,A,null),y(this,P,null)}}C=new WeakMap,M=new WeakMap,I=new WeakMap,Q=new WeakMap,Z=new WeakMap,K=new WeakMap,B=new WeakMap,tt=new WeakMap,z=new WeakMap,A=new WeakMap,P=new WeakMap,j=new WeakMap,W=new WeakSet,ct=function(t){y(this,j,t),e(this,M).updateRenderTime(t)},ht=function(){const t=e(this,H).step!==0;e(this,H).step=0,t&&(e(this,B).emit("paused"),e(this,T).suspend());for(const r of e(this,D))r.stop(),r.disconnect();e(this,D).clear()},T=new WeakMap,Y=new WeakMap,D=new WeakMap,yt=function(){var c;const t=e(this,I);let r=e(this,j);const{start:i,end:s,step:o,audioPlayAt:h}=e(this,H);o!==0&&r>=i&&r<s?r+=o:F(this,W,ht).call(this),F(this,W,ct).call(this,r);const a=[];for(const l of e(this,M).getSprites()){t.save();const{audio:d}=l.render(t,r-l.time.offset);t.restore(),a.push(d)}if(t.resetTransform(),o!==0){const l=Math.max(e(this,T).currentTime,h),d=Bt(a,e(this,T));let p=0;for(const u of d)u.start(l),u.connect(e(this,T).destination),u.connect(e(this,Y)),e(this,D).add(u),u.onended=()=>{u.disconnect(),e(this,D).delete(u)},p=Math.max(p,((c=u.buffer)==null?void 0:c.duration)??0);e(this,H).audioPlayAt=l+p}},H=new WeakMap,et=new WeakMap;function Bt(n,t){const r=[];if(n.length===0)return r;for(const[i,s]of n){if(i==null||i.length<=0)continue;const o=t.createBuffer(2,i.length,Ht.sampleRate);o.copyToChannel(i,0),o.copyToChannel(s??i,1);const h=t.createBufferSource();h.buffer=o,r.push(h)}return r}function jt(n){const t=n.createOscillator(),r=new Float32Array([0,0]),i=new Float32Array([0,0]),s=n.createPeriodicWave(r,i,{disableNormalization:!0});return t.setPeriodicWave(s),t.start(),t}function Yt(n,t,r,i,s,o){const h=t.width/t.height,a=s/o;let c=s,l=o,d=0,p=0;a>h?(l=s/t.width*t.height,p=(o-l)/2):(c=o/t.height*t.width,d=(s-c)/2),n.drawImage(t,r+d,i+p,c,l)}function Dt(n,t,r,i,s,o){const h=t.width/t.height,a=s/o;let c=s,l=o,d=0,p=0;a<h?(l=s/t.width*t.height,p=(o-l)/2):(c=o/t.height*t.width,d=(s-c)/2),n.drawImage(t,r+d,i+p,c,l)}w.AVCanvas=Pt,Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=av-canvas.umd.cjs.map
